\documentclass{ctexart}
\usepackage{listing}
\usepackage{amsmath}

\begin{document}
\title{操作系统}
\author{daydalek}
\date{\today}
\maketitle

\section{计算机系统概述}
\subsection{操作系统的基本概念}
计算机系统的层次(上到下):
\begin{itemize}
\item 用户
\item 应用程序
\item 操作系统
\item 硬件
\end {itemize}
操作系统(operating system)是指控制和管理整个计算机系统的硬件与软件资源,合理地组织,调度计算机的工作和资源的分配,进而为用户和其他软件提供方便接口与环境的程序集合.\\
操作系统是计算机系统中\textbf{最基本的}系统软件
\subsection{操作系统的特征}
\begin{itemize}
	\item 并发(Concurrent):两个或多个事件在同一时间间隔内发生,是宏观而论的一种概念.操作系统引入\textbf{进程}的概念就是为了使程序能够并发执行.
	      操作系统的并发是通过\textbf{分时}实现的.
	\item 共享(Sharing):系统中的资源可供内存中多个并发执行的进程共同使用.有以下两种共享方式:\\
	      \begin{itemize}
		      \item 互斥共享:资源在一段时间内只允许一个进程使用.
		      \item 同时共享:资源可供多个进程"同时"使用,这里的同时是宏观上的概念,把一个请求分几个时间片段间隔地完成.
	      \end{itemize}
	\item 虚拟(Virtual):把一个物理上的实体变为若干个逻辑上的对应物\\
	      操作系统的虚拟技术可以归纳为:
	      \begin{itemize}
		      \item 时分复用
		      \item 空分复用
	      \end{itemize}
	\item 异步(Asynchronous):指进程的执行不是一贯到底,而是走走停停,以不可知的速度向前推进.
\end{itemize}
并发和共享是操作系统两个\textbf{最基本的特征}.
\subsection{操作系统的目标和功能}
操作系统应具有以下功能:
\subsubsection{资源的管理者}
\begin{itemize}
	\item 处理机管理:可以归纳为进程管理,包括进程控制,同步,通信,死锁处理,处理机调度等
	\item 存储器管理:包括内存分配,回收,内存保护和共享,地址映射,内存扩充等
	\item 设备管理:完成用户的i/o请求,方便用户使用各种设备,提高设备的利用率.包括缓冲管理,设备分配,设备处理和虚拟设备等.
	\item 文件管理:包括文件存储空间的管理,目录管理及文件读写管理和保护等.
\end{itemize}
\subsubsection{用户的接口}
\begin{itemize}
	\item 命令接口:用户通过命令解释器向操作系统发出命令,操作系统解释并执行命令,强调交互性\\
	      \begin{itemize}
		      \item 联机命令接口:用户可以随时向操作系统发出命令,操作系统立即执行命令.\\
		      \item 脱机命令接口(批处理):用户将一组命令集中起来,一次性提交给操作系统,操作系统将这组命令集中的命令按照一定的顺序执行.
	      \end{itemize}
	\item 程序接口:用户可以通过编写程序来调用操作系统的服务.
\end{itemize}
\subsubsection{操作系统用作扩充机器}
没有任何软件支持的计算机称为\textbf{裸机}\\
通常把覆盖了软件的机器称为\textbf{扩充机器}或者\textbf{虚拟机}
\subsection{计算机系统的发展和分类}
计算机操作系统分为:
\begin{itemize}
	\item 分时操作系统:把处理器的运行时间分成很小的时间片,若一个时间片内不能完成计算则暂停运行,处理器让给
	      其他程序使用,这就是\textbf{时间片轮转}\\
	      分时操作系统的主要特征:
	      \begin{itemize}
		      \item 同时性:允许多个终端用户同时使用
		      \item 交互性:用户能够方便地进行人机对话
		      \item 独立性:多个用户可以同时操作而不彼此干扰
		      \item 及时性:用户请求能在很短的时间内得到响应
	      \end{itemize}
	\item 实时操作系统
	      分为硬实时和软实时,能够抢占式调度,保证系统在规定的时间内完成任务.
	      实时操作系统的主要特征:
	      \begin{itemize}
		      \item 及时性
		      \item 可靠性
	      \end{itemize}
	\item 批处理操作系统:分为单道批处理系统和多道批处理系统
	      单道批处理系统的特点:
	      \begin{itemize}
		      \item 自动性:程序的执行无需人工干预
		      \item 顺序性:各道作业程序顺序地进入内存,完成顺序也相同(FIFO)
		      \item 单道性:内存中仅有一道程序运行
	      \end{itemize}
	      多道批处理系统的特点:
	      \begin{itemize}
		      \item 多道:计算机内存内同时存放多道程序
		      \item 宏观上并行:同时进入内存的多个程序都在运行中,
		      \item 微观上串行:多道程序轮流占有cpu,轮流执行.
	      \end{itemize}
	      多道批处理系统的优点是资源利用率高.
\end{itemize}
\subsection{操作系统的运行环境}
\subsubsection{操作系统的运行机制}
大多数操作系统的内核包含以下内容
\begin{itemize}
\item 时钟管理
\item 中断机制
\item 原语(Atomic Operation):
\begin{itemize} 
    \item 处于操作系统最底层,最接近硬件 
    \item 具有原子性,操作只能一气呵成
	\item 运行时间较短,调用频繁 
\end{itemize}
\item 系统控制的数据结构及处理:常见的操作有
\begin{itemize}
    \item 进程管理
    \item 存储器管理
    \item 设备管理
\end{itemize}
\end{itemize}

\subsection{中断和异常的概念}
\begin{itemize}
    \item 中断(外中断):来自于cpu执行指令以外的事件发生,如外部设备的请求,时间片已到等.
    \item 异常(内中断,陷入):cpu执行指令内部的事件发生,例如非法操作码,地址越界等
\end{itemize}
\subsubsection{中断处理的过程}
\begin{itemize}
    \item 关中断
    \item 保存断点:为返回原来的地址,必须保存断点(即PC)
    \item 中断服务程序寻址:实质是取出中断服务程序的入口地址送入PC
    \item 保存现场和屏蔽字
    \item 开中断:允许更高级中断程序得到响应(因为已经保存完现场了)
    \item 执行中断服务程序:中断请求目的
    \item 关中断:保证在恢复现场和屏蔽字时不被更高级的中断程序打扰
    \item 恢复现场和屏蔽字
    \item 开中断,中断返回:返回到源程序的断点处,继续执行.
\end{itemize}
\subsection{系统调用}
指用户调用一些系统提供的子功能,按功能可以分为
\begin{itemize}
    \item 设备管理
    \item 文件管理
    \item 进程控制
    \item 进程通信
    \item 内存管理
\end{itemize}
这些处理需要内核负责完成.用户可以执行\textbf{陷入指令}(访管指令,trap指令)发起系统调用,请求系统提供服务,此时CPU从\textbf{用户态}
进入\textbf{核心态}.
下面是一些用户态转向核心态的例子
\begin{itemize}
    \item 用户要求系统调用
    \item 发生了一次中断
    \item 用户程序中产生了一个错误状态(异常)
    \item 用户程序企图执行一条特权指令
    \item 从核心态转向用户态(实现这个的指令本身也是特权命令,一般是中断返回命令)
\end{itemize}
访管指令是在用户态用的,因此它不是特权指令.
\end{document}